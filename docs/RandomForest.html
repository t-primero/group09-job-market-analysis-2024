<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Random Forest â€“ Geographic &amp; Remote Work Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6e9e233241ca8b655a357f549c91f0a8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Geographic &amp; Remote Work Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./introduction.html"> 
<span class="menu-text">Research Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./geographic_trends.html"> 
<span class="menu-text">Geographic Trends</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./tech_hub_analysis.html"> 
<span class="menu-text">Tech Hub Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./skill_gap_analysis.html"> 
<span class="menu-text">Skill Gap Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./RandomForest.html" aria-current="page"> 
<span class="menu-text">Random Forest</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#random-forest-model-deployment-interpretation" id="toc-random-forest-model-deployment-interpretation" class="nav-link active" data-scroll-target="#random-forest-model-deployment-interpretation">Random Forest Model Deployment &amp; Interpretation</a></li>
  <li><a href="#predictive-analysis" id="toc-predictive-analysis" class="nav-link" data-scroll-target="#predictive-analysis">Predictive Analysis</a></li>
  <li><a href="#kmeans-clustering-analysis" id="toc-kmeans-clustering-analysis" class="nav-link" data-scroll-target="#kmeans-clustering-analysis">KMeans Clustering Analysis</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Random Forest</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Random Forest Analysis</strong></p>
<p>The purpose of this analysis is to determine how much does salary depends on geography versus other variables such as years of experience, job field, remote/onsite work, and level of education.</p>
<p><strong>Variables Used</strong></p>
<p>The following variables will be used in the Random Forest model:</p>
<ul>
<li><ol type="1">
<li>Remote Type (On-Site/Remote)</li>
</ol></li>
<li><ol start="2" type="1">
<li>State Name</li>
</ol></li>
<li><ol start="3" type="1">
<li>Minimum Education levels</li>
</ol></li>
<li><ol start="4" type="1">
<li>NAICS Name</li>
</ol></li>
</ul>
<section id="random-forest-model-deployment-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="random-forest-model-deployment-interpretation">Random Forest Model Deployment &amp; Interpretation</h2>
<p>Before using the model for predictive analysis, we will measure how strong the model is.</p>
<p>The table below shows the following metrics:</p>
<p>RMSE (Root Mean Squared Error): Average error between predicted and actual salaries. MAE (Mean Absolute Error): Average error without considering direction (absolute value of the errors). R-Squared: Coefficient of determination that shows how well the predicted salaries approximates actual salaries.</p>
<div id="086c8691" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestRegressor(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    featuresCol<span class="op">=</span><span class="st">"features"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    labelCol<span class="op">=</span><span class="st">"SALARY"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    numTrees<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    maxDepth<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span><span class="dv">42</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> Pipeline(stages<span class="op">=</span>indexers <span class="op">+</span> encoders <span class="op">+</span> [assembler, rf])</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Train / Test Split - Using 80% of data for training and 20% for testing</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>train_df, test_df <span class="op">=</span> rf_df.randomSplit([<span class="fl">0.8</span>, <span class="fl">0.2</span>], seed<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit and Predict</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> pipeline.fit(train_df)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.transform(test_df)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># RMSE, MAE, R squared</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>ev <span class="op">=</span> RegressionEvaluator(labelCol<span class="op">=</span><span class="st">"SALARY"</span>, predictionCol<span class="op">=</span><span class="st">"prediction"</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>rmse <span class="op">=</span> ev.setMetricName(<span class="st">"rmse"</span>).evaluate(pred)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>mae  <span class="op">=</span> ev.setMetricName(<span class="st">"mae"</span>).evaluate(pred)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>r2   <span class="op">=</span> ev.setMetricName(<span class="st">"r2"</span>).evaluate(pred)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>rf_metrics <span class="op">=</span> pd.DataFrame({</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"RMSE"</span>: [rmse],</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MAE"</span>: [mae],</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"RÂ²"</span>: [r2]</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>}).<span class="bu">round</span>({<span class="st">"RMSE"</span>: <span class="dv">0</span>, <span class="st">"MAE"</span>: <span class="dv">0</span>, <span class="st">"RÂ²"</span>: <span class="dv">3</span>})</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>rf_metrics</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">RÂ²</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>38828.0</td>
<td>30056.0</td>
<td>0.194</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Interpretation: These variables collectively explains the salary by about 20%. Whereas in the testing data, the tested salaries were off by ~39K compared to the actual.</p>
<p><strong>Feature Importance</strong></p>
<p>Feature importance determines which variables used in the model had the most influence/impact on determining the salary. The graph below shows the top 20 variables used.</p>
<div id="30eb8945" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>rf_stage <span class="op">=</span> model.stages[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>importances <span class="op">=</span> np.array(rf_stage.featureImportances.toArray())</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>meta <span class="op">=</span> pred.schema[<span class="st">"features"</span>].metadata[<span class="st">"ml_attr"</span>][<span class="st">"attrs"</span>]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>attrs <span class="op">=</span> <span class="bu">sorted</span>([<span class="op">*</span>meta.get(<span class="st">"binary"</span>, []), <span class="op">*</span>meta.get(<span class="st">"numeric"</span>, [])], key<span class="op">=</span><span class="kw">lambda</span> a: a[<span class="st">"idx"</span>])</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> [a[<span class="st">"name"</span>] <span class="cf">for</span> a <span class="kw">in</span> attrs]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>topn <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>feat_imp <span class="op">=</span> (pd.DataFrame({<span class="st">"Feature"</span>: feature_names, <span class="st">"Importance"</span>: importances})</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>              .sort_values(<span class="st">"Importance"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>              .head(topn))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_label(s: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> re.sub(<span class="vs">r'</span><span class="kw">(</span><span class="vs">_ohe</span><span class="cf">|</span><span class="vs">_idx</span><span class="kw">)</span><span class="dv">$</span><span class="vs">'</span>, <span class="st">''</span>, s)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> s.replace(<span class="st">"MIN_EDULEVELS"</span>,<span class="st">"Education"</span>) <span class="op">\</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>         .replace(<span class="st">"NAICS2_NAME"</span>,<span class="st">"Industry"</span>) <span class="op">\</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>         .replace(<span class="st">"STATE_NAME"</span>,<span class="st">"State"</span>) <span class="op">\</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>         .replace(<span class="st">"REMOTE_TYPE"</span>,<span class="st">"Remote"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> textwrap.shorten(s, width<span class="op">=</span><span class="dv">28</span>, placeholder<span class="op">=</span><span class="st">"â€¦"</span>)  <span class="co"># wrap/shorten</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>feat_imp[<span class="st">"Label"</span>] <span class="op">=</span> feat_imp[<span class="st">"Feature"</span>].<span class="bu">map</span>(clean_label)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>feat_imp, x<span class="op">=</span><span class="st">"Importance"</span>, y<span class="op">=</span><span class="st">"Label"</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="ss">f"Top </span><span class="sc">{</span>topn<span class="sc">}</span><span class="ss"> Random Forest Feature Importances"</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Importance"</span>)<span class="op">;</span> plt.ylabel(<span class="st">"Feature"</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="RandomForest_files/figure-html/cell-8-output-1.png" width="853" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: Despite a relatively lower R squared value below 20% - this chart clearly shows that state (and ultimately location) has less influence on the amount of salary an employee receives compared to their education, position, and field.</p>
</section>
<section id="predictive-analysis" class="level2">
<h2 class="anchored" data-anchor-id="predictive-analysis">Predictive Analysis</h2>
<p>This analysis uses synthetic data to estimate what the Random Forest model would predict the salaries would be. There are 10 different variations of job type, state, education, etc. to predict each salary.</p>
<div id="86c89ce0" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pyspark.sql <span class="im">import</span> functions <span class="im">as</span> F</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="op">=</span> [<span class="st">"REMOTE_TYPE"</span>, <span class="st">"STATE_NAME"</span>, <span class="st">"MIN_EDULEVELS"</span>, <span class="st">"NAICS2_NAME"</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>num_cols <span class="op">=</span> [<span class="st">"MIN_YEARS_EXPERIENCE"</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generic data to test predictive analysis</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> [</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"REMOTE_TYPE"</span>: <span class="st">"Onsite"</span>, <span class="st">"STATE_NAME"</span>: <span class="st">"California"</span>, <span class="st">"MIN_EDULEVELS"</span>: <span class="st">"Master's"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>     <span class="st">"NAICS2_NAME"</span>: <span class="st">"Information"</span>, <span class="st">"MIN_YEARS_EXPERIENCE"</span>: <span class="fl">7.0</span>},</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"REMOTE_TYPE"</span>: <span class="st">"Remote"</span>, <span class="st">"STATE_NAME"</span>: <span class="st">"Texas"</span>, <span class="st">"MIN_EDULEVELS"</span>: <span class="st">"Associate or lower"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>     <span class="st">"NAICS2_NAME"</span>: <span class="st">"Administrative and Support and Waste Management and Remediation Services"</span>, <span class="st">"MIN_YEARS_EXPERIENCE"</span>: <span class="fl">2.0</span>},</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"REMOTE_TYPE"</span>: <span class="st">"Onsite"</span>, <span class="st">"STATE_NAME"</span>: <span class="st">"Washington"</span>, <span class="st">"MIN_EDULEVELS"</span>: <span class="st">"Bachelor"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>     <span class="st">"NAICS2_NAME"</span>: <span class="st">"Professional, Scientific, and Technical Services"</span>, <span class="st">"MIN_YEARS_EXPERIENCE"</span>: <span class="fl">12.0</span>},</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"REMOTE_TYPE"</span>: <span class="st">"Hybrid"</span>, <span class="st">"STATE_NAME"</span>: <span class="st">"Illinois"</span>, <span class="st">"MIN_EDULEVELS"</span>: <span class="st">"Bachelor"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>     <span class="st">"NAICS2_NAME"</span>: <span class="st">"Finance and Insurance"</span>, <span class="st">"MIN_YEARS_EXPERIENCE"</span>: <span class="fl">6.0</span>},</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"REMOTE_TYPE"</span>: <span class="st">"Onsite"</span>, <span class="st">"STATE_NAME"</span>: <span class="st">"New York"</span>, <span class="st">"MIN_EDULEVELS"</span>: <span class="st">"Master's"</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>     <span class="st">"NAICS2_NAME"</span>: <span class="st">"Educational Services"</span>, <span class="st">"MIN_YEARS_EXPERIENCE"</span>: <span class="fl">10.0</span>},</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"REMOTE_TYPE"</span>: <span class="st">"Hybrid"</span>, <span class="st">"STATE_NAME"</span>: <span class="st">"Florida"</span>, <span class="st">"MIN_EDULEVELS"</span>: <span class="st">"Bachelor"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>     <span class="st">"NAICS2_NAME"</span>: <span class="st">"Manufacturing"</span>, <span class="st">"MIN_YEARS_EXPERIENCE"</span>: <span class="fl">8.0</span>},</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"REMOTE_TYPE"</span>: <span class="st">"Onsite"</span>, <span class="st">"STATE_NAME"</span>: <span class="st">"Ohio"</span>, <span class="st">"MIN_EDULEVELS"</span>: <span class="st">"Associate or lower"</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>     <span class="st">"NAICS2_NAME"</span>: <span class="st">"Health Care and Social Assistance"</span>, <span class="st">"MIN_YEARS_EXPERIENCE"</span>: <span class="fl">3.0</span>},</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"REMOTE_TYPE"</span>: <span class="st">"Onsite"</span>, <span class="st">"STATE_NAME"</span>: <span class="st">"Virginia"</span>, <span class="st">"MIN_EDULEVELS"</span>: <span class="st">"PhD"</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>     <span class="st">"NAICS2_NAME"</span>: <span class="st">"Professional, Scientific, and Technical Services"</span>, <span class="st">"MIN_YEARS_EXPERIENCE"</span>: <span class="fl">9.0</span>},</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"REMOTE_TYPE"</span>: <span class="st">"Remote"</span>, <span class="st">"STATE_NAME"</span>: <span class="st">"Colorado"</span>, <span class="st">"MIN_EDULEVELS"</span>: <span class="st">"Bachelor"</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>     <span class="st">"NAICS2_NAME"</span>: <span class="st">"Real Estate and Rental and Leasing"</span>, <span class="st">"MIN_YEARS_EXPERIENCE"</span>: <span class="fl">7.0</span>},</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"REMOTE_TYPE"</span>: <span class="st">"Onsite"</span>, <span class="st">"STATE_NAME"</span>: <span class="st">"Michigan"</span>, <span class="st">"MIN_EDULEVELS"</span>: <span class="st">"Bachelor"</span>,</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>     <span class="st">"NAICS2_NAME"</span>: <span class="st">"Wholesale Trade"</span>, <span class="st">"MIN_YEARS_EXPERIENCE"</span>: <span class="fl">5.0</span>},</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> spark.createDataFrame(test_data)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Preventative for nulls in categoricals your pipeline indexes</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> new_df.fillna({c: <span class="st">"Unknown"</span> <span class="cf">for</span> c <span class="kw">in</span> cat_cols})</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting the salaries using trained pipeline model</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> model.transform(new_df)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>pred_pdf <span class="op">=</span> (</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    pred.select(</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>        F.col(<span class="st">"REMOTE_TYPE"</span>).alias(<span class="st">"Remote/Onsite"</span>),</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>        F.col(<span class="st">"STATE_NAME"</span>).alias(<span class="st">"State"</span>),</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>        F.col(<span class="st">"MIN_EDULEVELS"</span>).alias(<span class="st">"Education"</span>),</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>        F.col(<span class="st">"NAICS2_NAME"</span>).alias(<span class="st">"Industry"</span>),</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        F.col(<span class="st">"MIN_YEARS_EXPERIENCE"</span>).alias(<span class="st">"Min Yrs Exp"</span>),</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        F.col(<span class="st">"prediction"</span>).alias(<span class="st">"Predicted Salary"</span>),</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    .orderBy(F.col(<span class="st">"Predicted Salary"</span>).desc())</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    .toPandas()</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Round and format currency</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>pred_pdf[<span class="st">"Predicted Salary"</span>] <span class="op">=</span> pred_pdf[<span class="st">"Predicted Salary"</span>].<span class="bu">round</span>(<span class="dv">0</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a rank column</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>pred_pdf.insert(<span class="dv">0</span>, <span class="st">"#"</span>, <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(pred_pdf) <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Render a clean, index-free, currency-formatted table</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>pred_pdf.style.<span class="bu">format</span>({</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Predicted Salary"</span>: <span class="st">"$</span><span class="sc">{:,.0f}</span><span class="st">"</span>,</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Min Yrs Exp"</span>: <span class="st">"</span><span class="sc">{:.0f}</span><span class="st">"</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>}).hide(axis<span class="op">=</span><span class="st">"index"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<style type="text/css">
</style>

<table id="T_44b3b" class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_44b3b_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">#</th>
<th id="T_44b3b_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Remote/Onsite</th>
<th id="T_44b3b_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">State</th>
<th id="T_44b3b_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">Education</th>
<th id="T_44b3b_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">Industry</th>
<th id="T_44b3b_level0_col5" class="col_heading level0 col5" data-quarto-table-cell-role="th">Min Yrs Exp</th>
<th id="T_44b3b_level0_col6" class="col_heading level0 col6" data-quarto-table-cell-role="th">Predicted Salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_44b3b_row0_col0" class="data row0 col0">1</td>
<td id="T_44b3b_row0_col1" class="data row0 col1">Onsite</td>
<td id="T_44b3b_row0_col2" class="data row0 col2">Virginia</td>
<td id="T_44b3b_row0_col3" class="data row0 col3">PhD</td>
<td id="T_44b3b_row0_col4" class="data row0 col4">Professional, Scientific, and Technical Services</td>
<td id="T_44b3b_row0_col5" class="data row0 col5">9</td>
<td id="T_44b3b_row0_col6" class="data row0 col6">$231,918</td>
</tr>
<tr class="even">
<td id="T_44b3b_row1_col0" class="data row1 col0">2</td>
<td id="T_44b3b_row1_col1" class="data row1 col1">Onsite</td>
<td id="T_44b3b_row1_col2" class="data row1 col2">California</td>
<td id="T_44b3b_row1_col3" class="data row1 col3">Master's</td>
<td id="T_44b3b_row1_col4" class="data row1 col4">Information</td>
<td id="T_44b3b_row1_col5" class="data row1 col5">7</td>
<td id="T_44b3b_row1_col6" class="data row1 col6">$171,380</td>
</tr>
<tr class="odd">
<td id="T_44b3b_row2_col0" class="data row2 col0">3</td>
<td id="T_44b3b_row2_col1" class="data row2 col1">Onsite</td>
<td id="T_44b3b_row2_col2" class="data row2 col2">Washington</td>
<td id="T_44b3b_row2_col3" class="data row2 col3">Bachelor</td>
<td id="T_44b3b_row2_col4" class="data row2 col4">Professional, Scientific, and Technical Services</td>
<td id="T_44b3b_row2_col5" class="data row2 col5">12</td>
<td id="T_44b3b_row2_col6" class="data row2 col6">$139,904</td>
</tr>
<tr class="even">
<td id="T_44b3b_row3_col0" class="data row3 col0">4</td>
<td id="T_44b3b_row3_col1" class="data row3 col1">Hybrid</td>
<td id="T_44b3b_row3_col2" class="data row3 col2">Florida</td>
<td id="T_44b3b_row3_col3" class="data row3 col3">Bachelor</td>
<td id="T_44b3b_row3_col4" class="data row3 col4">Manufacturing</td>
<td id="T_44b3b_row3_col5" class="data row3 col5">8</td>
<td id="T_44b3b_row3_col6" class="data row3 col6">$122,962</td>
</tr>
<tr class="odd">
<td id="T_44b3b_row4_col0" class="data row4 col0">5</td>
<td id="T_44b3b_row4_col1" class="data row4 col1">Hybrid</td>
<td id="T_44b3b_row4_col2" class="data row4 col2">Illinois</td>
<td id="T_44b3b_row4_col3" class="data row4 col3">Bachelor</td>
<td id="T_44b3b_row4_col4" class="data row4 col4">Finance and Insurance</td>
<td id="T_44b3b_row4_col5" class="data row4 col5">6</td>
<td id="T_44b3b_row4_col6" class="data row4 col6">$121,860</td>
</tr>
<tr class="even">
<td id="T_44b3b_row5_col0" class="data row5 col0">6</td>
<td id="T_44b3b_row5_col1" class="data row5 col1">Remote</td>
<td id="T_44b3b_row5_col2" class="data row5 col2">Texas</td>
<td id="T_44b3b_row5_col3" class="data row5 col3">Associate or lower</td>
<td id="T_44b3b_row5_col4" class="data row5 col4">Administrative and Support and Waste Management and Remediation Services</td>
<td id="T_44b3b_row5_col5" class="data row5 col5">2</td>
<td id="T_44b3b_row5_col6" class="data row5 col6">$115,777</td>
</tr>
<tr class="odd">
<td id="T_44b3b_row6_col0" class="data row6 col0">7</td>
<td id="T_44b3b_row6_col1" class="data row6 col1">Onsite</td>
<td id="T_44b3b_row6_col2" class="data row6 col2">Michigan</td>
<td id="T_44b3b_row6_col3" class="data row6 col3">Bachelor</td>
<td id="T_44b3b_row6_col4" class="data row6 col4">Wholesale Trade</td>
<td id="T_44b3b_row6_col5" class="data row6 col5">5</td>
<td id="T_44b3b_row6_col6" class="data row6 col6">$113,347</td>
</tr>
<tr class="even">
<td id="T_44b3b_row7_col0" class="data row7 col0">8</td>
<td id="T_44b3b_row7_col1" class="data row7 col1">Remote</td>
<td id="T_44b3b_row7_col2" class="data row7 col2">Colorado</td>
<td id="T_44b3b_row7_col3" class="data row7 col3">Bachelor</td>
<td id="T_44b3b_row7_col4" class="data row7 col4">Real Estate and Rental and Leasing</td>
<td id="T_44b3b_row7_col5" class="data row7 col5">7</td>
<td id="T_44b3b_row7_col6" class="data row7 col6">$111,173</td>
</tr>
<tr class="odd">
<td id="T_44b3b_row8_col0" class="data row8 col0">9</td>
<td id="T_44b3b_row8_col1" class="data row8 col1">Onsite</td>
<td id="T_44b3b_row8_col2" class="data row8 col2">Ohio</td>
<td id="T_44b3b_row8_col3" class="data row8 col3">Associate or lower</td>
<td id="T_44b3b_row8_col4" class="data row8 col4">Health Care and Social Assistance</td>
<td id="T_44b3b_row8_col5" class="data row8 col5">3</td>
<td id="T_44b3b_row8_col6" class="data row8 col6">$102,261</td>
</tr>
<tr class="even">
<td id="T_44b3b_row9_col0" class="data row9 col0">10</td>
<td id="T_44b3b_row9_col1" class="data row9 col1">Onsite</td>
<td id="T_44b3b_row9_col2" class="data row9 col2">New York</td>
<td id="T_44b3b_row9_col3" class="data row9 col3">Master's</td>
<td id="T_44b3b_row9_col4" class="data row9 col4">Educational Services</td>
<td id="T_44b3b_row9_col5" class="data row9 col5">10</td>
<td id="T_44b3b_row9_col6" class="data row9 col6">$75,983</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Interpretation: The results are varied - in some instances the results align with our previous analysis - higher eduction, onsite, and tech should see higher salaries. For example, the first line and eigth line do have the highest salaries being in information and tech alongside 5+ years of experience, onsite, and higher education completed. However, the fith line has the lowest salary, but does not necessarily align in an intuitive sense - 10 years of experience, Masters, onsite, etc. should be ranked higher.</p>
</section>
<section id="kmeans-clustering-analysis" class="level2">
<h2 class="anchored" data-anchor-id="kmeans-clustering-analysis">KMeans Clustering Analysis</h2>
<p>This analysis explores salary and years of experience by the NAICS Name. As shown below, three groups have been for various NAICSâ€™s, with years of experience horizontally, and salary on the vertical axis.</p>
<div id="b4fa641c" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizing the results</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>plot_pdf <span class="op">=</span> pred.select(<span class="st">"MIN_YEARS_EXPERIENCE"</span>, <span class="st">"SALARY"</span>, <span class="st">"cluster"</span>) <span class="op">\</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>               .sample(<span class="va">False</span>, <span class="fl">0.25</span>, <span class="dv">42</span>).toPandas()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> plt.scatter(plot_pdf[<span class="st">"MIN_YEARS_EXPERIENCE"</span>], plot_pdf[<span class="st">"SALARY"</span>], c<span class="op">=</span>plot_pdf[<span class="st">"cluster"</span>], alpha<span class="op">=</span><span class="fl">.6</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"MIN_YEARS_EXPERIENCE"</span>)<span class="op">;</span> plt.ylabel(<span class="st">"SALARY"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Clustering by NAICS2"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>handles,_ <span class="op">=</span> s.legend_elements()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>plt.legend(handles, [<span class="ss">f"Cluster </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">sorted</span>(plot_pdf[<span class="st">'cluster'</span>].unique())], title<span class="op">=</span><span class="st">"Clusters"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">.3</span>)<span class="op">;</span> plt.tight_layout()<span class="op">;</span> plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="RandomForest_files/figure-html/cell-11-output-1.png" width="758" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: The KMeans cluster mostly uses salaries to separate each cluster group - while some clusters pay lower or higher pay at the same years of experience, this suggests that the industry does influence salaries at different levels of experience. Overall, salaries generally rise with experience, though industry effects can override that pattern.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>